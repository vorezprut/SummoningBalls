[gd_scene load_steps=20 format=3 uid="uid://bo184rv3wlooe"]

[ext_resource type="PackedScene" uid="uid://duujwcst2ca2q" path="res://player.tscn" id="1_lyw3e"]
[ext_resource type="Script" path="res://main.gd" id="1_x6rd7"]
[ext_resource type="PackedScene" uid="uid://cne1e3tesf6ls" path="res://demon.tscn" id="2_ao4d7"]
[ext_resource type="PackedScene" uid="uid://dxcvdknkt2noy" path="res://block.tscn" id="3_w16xs"]
[ext_resource type="PackedScene" uid="uid://ccep30chjdac6" path="res://spawn.tscn" id="4_62msg"]
[ext_resource type="Shader" path="res://main.gdshader" id="5_dyjnw"]
[ext_resource type="PackedScene" uid="uid://ckxehb6c5xtaw" path="res://human.tscn" id="5_vt15w"]

[sub_resource type="NavigationMesh" id="NavigationMesh_axswn"]
vertices = PackedVector3Array(-7.0585, 0.404779, -41.313, -4.5585, 0.404779, -41.813, -4.8085, 0.404779, -93.563, -7.5585, 0.404779, -39.813, -7.0585, 0.404779, -41.313, -4.8085, 0.404779, -93.563, -94.0585, 0.404779, -93.563, -94.0585, 0.404779, -39.813, -4.5585, 0.404779, -41.813, 0.941498, 0.404779, -41.813, 1.1915, 0.404779, -93.563, -4.8085, 0.404779, -93.563, 1.1915, 0.404779, -93.563, 0.941498, 0.404779, -41.813, 3.4415, 0.404779, -41.313, 1.1915, 0.404779, -93.563, 3.4415, 0.404779, -41.313, 4.1915, 0.404779, -40.063, 93.9415, 0.404779, -38.813, 93.9415, 0.404779, -93.563, 4.1915, 0.404779, -40.063, 4.1915, 0.404779, -38.563, 93.9415, 0.404779, -38.813, 48.9415, 10.9048, -41.313, 55.1915, 10.9048, -41.313, 55.1915, 10.9048, -83.063, 48.9415, 10.9048, -83.063, 47.1915, 10.9048, -37.813, 45.6915, 10.9048, -37.813, 45.9415, 10.9048, -31.563, 55.1915, 10.9048, -41.313, 48.9415, 10.9048, -41.313, 48.4415, 10.9048, -38.563, 48.4415, 10.9048, -38.563, 47.1915, 10.9048, -37.813, 45.9415, 10.9048, -31.563, 55.4415, 10.9048, -31.563, 55.1915, 10.9048, -41.313, -7.0585, 0.404779, -31.063, -4.3085, 1.65478, -31.563, -4.3085, 1.65478, -37.813, -7.0585, 0.404779, -38.313, -7.5585, 0.404779, -29.563, -7.0585, 0.404779, -31.063, -7.0585, 0.404779, -38.313, -7.5585, 0.404779, -39.813, -94.0585, 0.404779, -39.813, -94.0585, 0.404779, -29.563, 4.1915, 0.404779, -38.563, 4.1915, 0.404779, -30.813, 93.9415, 0.404779, -30.563, 93.9415, 0.404779, -38.813, -26.0585, -11.0952, -37.813, -26.0585, -11.0952, -31.563, -13.0585, -3.34522, -31.563, -13.0585, -3.34522, -37.813, -4.3085, 1.65478, -31.563, 45.9415, 10.9048, -31.563, 45.6915, 10.9048, -37.813, -4.3085, 1.65478, -37.813, 10.2802, 10.4048, -31.563, 11.9012, 10.9048, -31.563, 11.8205, 10.9048, -37.813, 10.2076, 10.4048, -37.813, 5.92657, 7.90478, -35.5721, 4.1915, 0.404779, -29.313, 3.6915, 0.404779, -28.563, 14.1915, 0.404779, 7.187, 4.1915, 0.404779, -30.813, 4.1915, 0.404779, -29.313, 14.1915, 0.404779, 7.187, 25.1915, 0.404779, 6.937, 26.9415, 0.404779, 8.687, 26.9415, 0.404779, 10.687, 93.9415, 0.404779, 10.687, 4.1915, 0.404779, -30.813, 25.1915, 0.404779, 6.937, 26.1915, 0.404779, 7.437, 4.1915, 0.404779, -30.813, 26.1915, 0.404779, 7.437, 26.9415, 0.404779, 8.687, 93.9415, 0.404779, 10.687, 93.9415, 0.404779, -30.563, 12.6915, 0.404779, 8.687, 13.1915, 0.404779, 7.937, 2.6915, 0.404779, -27.813, -6.0585, 0.404779, -27.563, -7.0585, 0.404779, -28.063, -7.5585, 0.404779, -29.563, -94.0585, 0.404779, -29.563, 12.6915, 0.404779, 8.687, -6.0585, 0.404779, -27.563, -7.0585, 0.404779, -28.063, -94.0585, 0.404779, -29.563, -94.0585, 0.404779, 18.187, 12.6915, 0.404779, 17.937, 2.6915, 0.404779, -27.813, 13.1915, 0.404779, 7.937, 14.1915, 0.404779, 7.187, 3.6915, 0.404779, -28.563, 26.9415, 0.404779, 17.437, 93.9415, 0.404779, 17.437, 93.9415, 0.404779, 10.687, 26.9415, 0.404779, 10.687, 16.6915, 23.9048, 10.937, 16.6915, 23.9048, 17.187, 22.9415, 23.9048, 17.187, 22.9415, 23.9048, 10.937, 16.9415, 0.404779, 11.187, 16.9415, 0.404779, 16.937, 22.6915, 0.404779, 16.937, 22.6915, 0.404779, 11.187, 93.9415, 0.404779, 17.437, 26.9415, 0.404779, 17.437, 26.9415, 0.404779, 19.437, 93.9415, 0.404779, 17.437, 26.9415, 0.404779, 19.437, 26.1915, 0.404779, 20.687, 93.9415, 0.404779, 17.437, 26.1915, 0.404779, 20.687, 25.1915, 0.404779, 21.187, 23.1915, 0.404779, 93.687, 93.9415, 0.404779, 93.687, 25.1915, 0.404779, 21.187, 23.1915, 0.404779, 21.187, 23.1915, 0.404779, 93.687, 16.4415, 0.404779, 93.687, 16.4415, 0.404779, 21.187, 14.4415, 0.404779, 21.187, 16.4415, 0.404779, 93.687, 14.4415, 0.404779, 21.187, 13.4415, 0.404779, 20.687, 16.4415, 0.404779, 93.687, 13.4415, 0.404779, 20.687, 12.6915, 0.404779, 19.437, -94.0585, 0.404779, 18.187, -94.0585, 0.404779, 93.687, 12.6915, 0.404779, 19.437, 12.6915, 0.404779, 17.937, -94.0585, 0.404779, 18.187, 16.4415, 0.404779, 93.687, 23.1915, 0.404779, 93.687, 23.1915, 0.404779, 21.187, 16.4415, 0.404779, 21.187)
polygons = [PackedInt32Array(2, 1, 0), PackedInt32Array(4, 3, 5), PackedInt32Array(5, 3, 7), PackedInt32Array(5, 7, 6), PackedInt32Array(8, 11, 9), PackedInt32Array(9, 11, 10), PackedInt32Array(12, 14, 13), PackedInt32Array(16, 15, 17), PackedInt32Array(17, 15, 19), PackedInt32Array(17, 19, 18), PackedInt32Array(22, 21, 20), PackedInt32Array(26, 25, 23), PackedInt32Array(23, 25, 24), PackedInt32Array(29, 28, 27), PackedInt32Array(32, 31, 30), PackedInt32Array(34, 33, 35), PackedInt32Array(35, 33, 36), PackedInt32Array(36, 33, 37), PackedInt32Array(39, 38, 40), PackedInt32Array(40, 38, 41), PackedInt32Array(43, 42, 44), PackedInt32Array(44, 42, 45), PackedInt32Array(45, 42, 47), PackedInt32Array(45, 47, 46), PackedInt32Array(48, 51, 49), PackedInt32Array(49, 51, 50), PackedInt32Array(55, 54, 52), PackedInt32Array(52, 54, 53), PackedInt32Array(63, 64, 59), PackedInt32Array(59, 64, 56), PackedInt32Array(56, 64, 60), PackedInt32Array(60, 62, 61), PackedInt32Array(61, 58, 57), PackedInt32Array(58, 61, 62), PackedInt32Array(62, 60, 63), PackedInt32Array(63, 60, 64), PackedInt32Array(65, 67, 66), PackedInt32Array(69, 68, 70), PackedInt32Array(70, 68, 71), PackedInt32Array(74, 73, 72), PackedInt32Array(75, 77, 76), PackedInt32Array(79, 78, 80), PackedInt32Array(80, 78, 81), PackedInt32Array(81, 78, 82), PackedInt32Array(84, 83, 85), PackedInt32Array(85, 83, 86), PackedInt32Array(87, 89, 88), PackedInt32Array(91, 90, 92), PackedInt32Array(92, 90, 95), PackedInt32Array(92, 95, 93), PackedInt32Array(93, 95, 94), PackedInt32Array(99, 98, 96), PackedInt32Array(96, 98, 97), PackedInt32Array(103, 102, 100), PackedInt32Array(100, 102, 101), PackedInt32Array(107, 106, 104), PackedInt32Array(104, 106, 105), PackedInt32Array(111, 110, 108), PackedInt32Array(108, 110, 109), PackedInt32Array(114, 113, 112), PackedInt32Array(117, 116, 115), PackedInt32Array(119, 118, 120), PackedInt32Array(120, 118, 122), PackedInt32Array(120, 122, 121), PackedInt32Array(125, 124, 123), PackedInt32Array(128, 127, 126), PackedInt32Array(131, 130, 129), PackedInt32Array(133, 132, 134), PackedInt32Array(134, 132, 136), PackedInt32Array(134, 136, 135), PackedInt32Array(139, 138, 137), PackedInt32Array(143, 142, 140), PackedInt32Array(140, 142, 141)]
agent_radius = 2.0

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_olwi7"]
albedo_color = Color(0.0823529, 0.0431373, 0, 1)

[sub_resource type="BoxMesh" id="BoxMesh_f6p37"]
material = SubResource("StandardMaterial3D_olwi7")

[sub_resource type="WorldBoundaryShape3D" id="WorldBoundaryShape3D_j1mef"]

[sub_resource type="ViewportTexture" id="ViewportTexture_ppag0"]
viewport_path = NodePath("blood_vp")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_n1ith"]
resource_local_to_scene = true
transparency = 1
albedo_texture = SubResource("ViewportTexture_ppag0")
metallic = 0.8

[sub_resource type="QuadMesh" id="QuadMesh_6q5hr"]
resource_local_to_scene = true
material = SubResource("StandardMaterial3D_n1ith")
size = Vector2(100, 100)
orientation = 1

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_73iq2"]

[sub_resource type="Sky" id="Sky_c1ph8"]
sky_material = SubResource("ProceduralSkyMaterial_73iq2")

[sub_resource type="Environment" id="Environment_lshbg"]
sky = SubResource("Sky_c1ph8")
ambient_light_source = 3
ambient_light_sky_contribution = 0.3
ambient_light_energy = 0.1
fog_density = 0.001

[sub_resource type="CameraAttributesPractical" id="CameraAttributesPractical_wxt5t"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_t2yig"]
shader = ExtResource("5_dyjnw")

[node name="main" type="Node3D"]
script = ExtResource("1_x6rd7")
blood_color = Color(0.741176, 0, 0, 0.831373)

[node name="Demon" parent="." instance=ExtResource("2_ao4d7")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.09976, 0)

[node name="NavigationRegion3D" type="NavigationRegion3D" parent="."]
navigation_mesh = SubResource("NavigationMesh_axswn")

[node name="Ground" type="StaticBody3D" parent="NavigationRegion3D"]

[node name="MeshInstance3D" type="MeshInstance3D" parent="NavigationRegion3D/Ground"]
transform = Transform3D(192.117, 0, 0, 0, 1, 0, 0, 0, 191.126, 0, -0.51, 0)
mesh = SubResource("BoxMesh_f6p37")
skeleton = NodePath("../../..")

[node name="CollisionShape3D" type="CollisionShape3D" parent="NavigationRegion3D/Ground"]
shape = SubResource("WorldBoundaryShape3D_j1mef")

[node name="bloodplane" type="MeshInstance3D" parent="NavigationRegion3D/Ground"]
unique_name_in_owner = true
mesh = SubResource("QuadMesh_6q5hr")

[node name="building" parent="NavigationRegion3D" instance=ExtResource("3_w16xs")]
transform = Transform3D(10, 0, 0, 0, 23.8674, 0, 0, 0, 10, 19.8131, 11.591, 14.0598)

[node name="building2" parent="NavigationRegion3D" instance=ExtResource("3_w16xs")]
transform = Transform3D(45.7499, 0, 0, 0, 2.85111, 0, 0, 0, 10, 34.4428, 9.1279, -34.7345)

[node name="building4" parent="NavigationRegion3D" instance=ExtResource("3_w16xs")]
transform = Transform3D(-1.99979e-06, 0, 10, 0, 2.85111, 0, -45.7499, 0, -4.37114e-07, 52.116, 9.1279, -62.069)

[node name="building3" parent="NavigationRegion3D" instance=ExtResource("3_w16xs")]
transform = Transform3D(39.3995, -1.44915, 0, 23.2535, 2.45536, 0, 0, 0, 10, -7.42282, -2.24079, -34.7345)

[node name="Player" parent="." instance=ExtResource("1_lyw3e")]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -3, 3, 0)

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_lshbg")
camera_attributes = SubResource("CameraAttributesPractical_wxt5t")

[node name="Camera" type="Camera3D" parent="."]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 0.374218, 0.927341, 0, -0.927341, 0.374218, -3, 19.3932, 0)
current = true

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="Camera"]
transform = Transform3D(-0.39391, 0.633189, -0.666264, -0.852365, 0.019617, 0.52258, 0.343962, 0.773749, 0.53198, 1.02542, -0.720765, -15.679)
shadow_enabled = true
directional_shadow_split_1 = 0.41
directional_shadow_split_2 = 0.627
directional_shadow_split_3 = 0.803
directional_shadow_max_distance = 59.0

[node name="CanvasLayer" type="CanvasLayer" parent="Camera"]
visible = false

[node name="ColorRect" type="ColorRect" parent="Camera/CanvasLayer"]
material = SubResource("ShaderMaterial_t2yig")
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="Spawn" parent="." instance=ExtResource("4_62msg")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 5, 0, -12)

[node name="NPC" parent="." instance=ExtResource("5_vt15w")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 10.5265, 0, -13.7646)

[node name="NPC2" parent="." instance=ExtResource("5_vt15w")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -21.3856, 0, -8.70348)

[node name="NPC3" parent="." instance=ExtResource("5_vt15w")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -11.6486, 0, -18.7293)

[node name="NPC4" parent="." instance=ExtResource("5_vt15w")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -20.1752, 0, 13.4393)
bullet_mass = 0.1
bullet_impact = 50.0
bullet_max_killed = 1
firerate = 0.2

[node name="NPC5" parent="." instance=ExtResource("5_vt15w")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -18.1439, 0, 17.2188)
bullet_mass = 0.1
bullet_impact = 50.0
bullet_max_killed = 1
firerate = 0.2

[node name="NPC6" parent="." instance=ExtResource("5_vt15w")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -21.9646, 0, 20.0192)
bullet_mass = 0.1
bullet_impact = 50.0
bullet_max_killed = 1
firerate = 0.2

[node name="NPC10" parent="." instance=ExtResource("5_vt15w")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 52.6638, 10.5122, -79.2925)
bullet_mass = 0.1
bullet_impact = 50.0
bullet_max_killed = 1
firerate = 0.2

[node name="NPC7" parent="." instance=ExtResource("5_vt15w")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -16.5216, 0, 23.1146)
bullet_mass = 0.1
bullet_impact = 50.0
bullet_max_killed = 1
firerate = 0.2

[node name="NPC8" parent="." instance=ExtResource("5_vt15w")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -22.6608, 0, 16.6457)
bullet_mass = 0.1
bullet_impact = 50.0
bullet_max_killed = 1
firerate = 0.2

[node name="NPC9" parent="." instance=ExtResource("5_vt15w")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -17.8482, 0, 20.938)
bullet_mass = 0.1
bullet_impact = 50.0
bullet_max_killed = 1
firerate = 0.2

[node name="blood_vp" type="SubViewport" parent="."]
unique_name_in_owner = true
transparent_bg = true
size = Vector2i(1024, 1024)
render_target_clear_mode = 1

[node name="pen" type="Node2D" parent="blood_vp"]
unique_name_in_owner = true

[connection signal="draw" from="blood_vp/pen" to="." method="_on_draw_blood"]
